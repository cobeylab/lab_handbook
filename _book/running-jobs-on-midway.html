<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Cobey Lab Handbook</title>
  <meta name="description" content="Handbook for the Cobey Lab at the University of Chicago">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Cobey Lab Handbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Handbook for the Cobey Lab at the University of Chicago" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Cobey Lab Handbook" />
  
  <meta name="twitter:description" content="Handbook for the Cobey Lab at the University of Chicago" />
  



<meta name="date" content="2018-10-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="configuring-software-on-midway.html">
<link rel="next" href="onboarding.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />










<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="why.html"><a href="why.html"><i class="fa fa-check"></i><b>1</b> Why we work</a></li>
<li class="chapter" data-level="2" data-path="how-we-work.html"><a href="how-we-work.html"><i class="fa fa-check"></i><b>2</b> How we work</a><ul>
<li class="chapter" data-level="2.1" data-path="how-we-work.html"><a href="how-we-work.html#principles"><i class="fa fa-check"></i><b>2.1</b> Principles</a></li>
<li class="chapter" data-level="2.2" data-path="how-we-work.html"><a href="how-we-work.html#work-hours"><i class="fa fa-check"></i><b>2.2</b> Work hours</a></li>
<li class="chapter" data-level="2.3" data-path="how-we-work.html"><a href="how-we-work.html#workspace"><i class="fa fa-check"></i><b>2.3</b> Workspace</a></li>
<li class="chapter" data-level="2.4" data-path="how-we-work.html"><a href="how-we-work.html#communication"><i class="fa fa-check"></i><b>2.4</b> Communication</a></li>
<li class="chapter" data-level="2.5" data-path="how-we-work.html"><a href="how-we-work.html#weekly-check-ins"><i class="fa fa-check"></i><b>2.5</b> Weekly check-ins</a></li>
<li class="chapter" data-level="2.6" data-path="how-we-work.html"><a href="how-we-work.html#lab-meetings"><i class="fa fa-check"></i><b>2.6</b> Lab meetings</a></li>
<li class="chapter" data-level="2.7" data-path="how-we-work.html"><a href="how-we-work.html#reproducible-research"><i class="fa fa-check"></i><b>2.7</b> Reproducible research</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="performance.html"><a href="performance.html"><i class="fa fa-check"></i><b>3</b> Performance</a><ul>
<li class="chapter" data-level="3.1" data-path="performance.html"><a href="performance.html#reviews"><i class="fa fa-check"></i><b>3.1</b> Reviews</a></li>
<li class="chapter" data-level="3.2" data-path="performance.html"><a href="performance.html#my-commitments"><i class="fa fa-check"></i><b>3.2</b> My commitments</a></li>
<li class="chapter" data-level="3.3" data-path="performance.html"><a href="performance.html#basic-expectations"><i class="fa fa-check"></i><b>3.3</b> Basic expectations</a></li>
<li class="chapter" data-level="3.4" data-path="performance.html"><a href="performance.html#graduate-researchers"><i class="fa fa-check"></i><b>3.4</b> Graduate researchers</a></li>
<li class="chapter" data-level="3.5" data-path="performance.html"><a href="performance.html#postdoctoral-researchers"><i class="fa fa-check"></i><b>3.5</b> Postdoctoral researchers</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="so-you-wanna.html"><a href="so-you-wanna.html"><i class="fa fa-check"></i><b>4</b> So you wanna…</a><ul>
<li class="chapter" data-level="4.1" data-path="so-you-wanna.html"><a href="so-you-wanna.html#join-the-lab"><i class="fa fa-check"></i><b>4.1</b> Join the lab</a></li>
<li class="chapter" data-level="4.2" data-path="so-you-wanna.html"><a href="so-you-wanna.html#do-some-research"><i class="fa fa-check"></i><b>4.2</b> Do some research</a></li>
<li class="chapter" data-level="4.3" data-path="so-you-wanna.html"><a href="so-you-wanna.html#code-well-and-efficiently"><i class="fa fa-check"></i><b>4.3</b> Code well and efficiently</a></li>
<li class="chapter" data-level="4.4" data-path="so-you-wanna.html"><a href="so-you-wanna.html#write-well"><i class="fa fa-check"></i><b>4.4</b> Write well</a></li>
<li class="chapter" data-level="4.5" data-path="so-you-wanna.html"><a href="so-you-wanna.html#write-good-emails"><i class="fa fa-check"></i><b>4.5</b> Write good emails</a></li>
<li class="chapter" data-level="4.6" data-path="so-you-wanna.html"><a href="so-you-wanna.html#make-nice-figures"><i class="fa fa-check"></i><b>4.6</b> Make nice figures</a></li>
<li class="chapter" data-level="4.7" data-path="so-you-wanna.html"><a href="so-you-wanna.html#keep-up-with-the-literature"><i class="fa fa-check"></i><b>4.7</b> Keep up with the literature</a></li>
<li class="chapter" data-level="4.8" data-path="so-you-wanna.html"><a href="so-you-wanna.html#get-funded"><i class="fa fa-check"></i><b>4.8</b> Get funded</a></li>
<li class="chapter" data-level="4.9" data-path="so-you-wanna.html"><a href="so-you-wanna.html#do-peer-review"><i class="fa fa-check"></i><b>4.9</b> Do peer review</a></li>
<li class="chapter" data-level="4.10" data-path="so-you-wanna.html"><a href="so-you-wanna.html#have-productive-meetings"><i class="fa fa-check"></i><b>4.10</b> Have productive meetings</a></li>
<li class="chapter" data-level="4.11" data-path="so-you-wanna.html"><a href="so-you-wanna.html#book-travel"><i class="fa fa-check"></i><b>4.11</b> Book travel</a></li>
<li class="chapter" data-level="4.12" data-path="so-you-wanna.html"><a href="so-you-wanna.html#use-midway"><i class="fa fa-check"></i><b>4.12</b> Use Midway</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="about-midway.html"><a href="about-midway.html"><i class="fa fa-check"></i><b>5</b> About Midway</a></li>
<li class="chapter" data-level="6" data-path="storage-on-midway.html"><a href="storage-on-midway.html"><i class="fa fa-check"></i><b>6</b> Storage on Midway</a></li>
<li class="chapter" data-level="7" data-path="connecting-to-midway.html"><a href="connecting-to-midway.html"><i class="fa fa-check"></i><b>7</b> Connecting to Midway</a><ul>
<li class="chapter" data-level="7.1" data-path="connecting-to-midway.html"><a href="connecting-to-midway.html#ssh-terminal"><i class="fa fa-check"></i><b>7.1</b> SSH (terminal)</a></li>
<li class="chapter" data-level="7.2" data-path="connecting-to-midway.html"><a href="connecting-to-midway.html#scp"><i class="fa fa-check"></i><b>7.2</b> SCP</a></li>
<li class="chapter" data-level="7.3" data-path="connecting-to-midway.html"><a href="connecting-to-midway.html#smb-connect-as-a-disk"><i class="fa fa-check"></i><b>7.3</b> SMB (connect as a disk)</a></li>
<li class="chapter" data-level="7.4" data-path="connecting-to-midway.html"><a href="connecting-to-midway.html#ssh--x-terminal-with-graphical-forwarding"><i class="fa fa-check"></i><b>7.4</b> ssh -X (terminal with graphical forwarding)</a></li>
<li class="chapter" data-level="7.5" data-path="connecting-to-midway.html"><a href="connecting-to-midway.html#vnc-graphical-interface-via-thinlinc"><i class="fa fa-check"></i><b>7.5</b> VNC (graphical interface via ThinLinc)</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="configuring-software-on-midway.html"><a href="configuring-software-on-midway.html"><i class="fa fa-check"></i><b>8</b> Configuring Software on Midway</a><ul>
<li class="chapter" data-level="8.1" data-path="configuring-software-on-midway.html"><a href="configuring-software-on-midway.html#git"><i class="fa fa-check"></i><b>8.1</b> Git</a></li>
<li class="chapter" data-level="8.2" data-path="configuring-software-on-midway.html"><a href="configuring-software-on-midway.html#java"><i class="fa fa-check"></i><b>8.2</b> Java</a></li>
<li class="chapter" data-level="8.3" data-path="configuring-software-on-midway.html"><a href="configuring-software-on-midway.html#cc"><i class="fa fa-check"></i><b>8.3</b> C/C++</a></li>
<li class="chapter" data-level="8.4" data-path="configuring-software-on-midway.html"><a href="configuring-software-on-midway.html#r"><i class="fa fa-check"></i><b>8.4</b> R</a></li>
<li class="chapter" data-level="8.5" data-path="configuring-software-on-midway.html"><a href="configuring-software-on-midway.html#python"><i class="fa fa-check"></i><b>8.5</b> Python</a></li>
<li class="chapter" data-level="8.6" data-path="configuring-software-on-midway.html"><a href="configuring-software-on-midway.html#matlab-and-mathematica"><i class="fa fa-check"></i><b>8.6</b> Matlab and Mathematica</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html"><i class="fa fa-check"></i><b>9</b> Running Jobs on Midway</a><ul>
<li class="chapter" data-level="9.1" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#overview"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#job-structure"><i class="fa fa-check"></i><b>9.2</b> Job structure</a></li>
<li class="chapter" data-level="9.3" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#priority"><i class="fa fa-check"></i><b>9.3</b> Priority</a></li>
<li class="chapter" data-level="9.4" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#useful-commands"><i class="fa fa-check"></i><b>9.4</b> Useful commands</a><ul>
<li class="chapter" data-level="9.4.1" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#sinteractive"><i class="fa fa-check"></i><b>9.4.1</b> sinteractive</a></li>
<li class="chapter" data-level="9.4.2" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#sbatch"><i class="fa fa-check"></i><b>9.4.2</b> sbatch</a></li>
<li class="chapter" data-level="9.4.3" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#squeue"><i class="fa fa-check"></i><b>9.4.3</b> squeue</a></li>
<li class="chapter" data-level="9.4.4" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#scancel"><i class="fa fa-check"></i><b>9.4.4</b> scancel</a></li>
<li class="chapter" data-level="9.4.5" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#accounts"><i class="fa fa-check"></i><b>9.4.5</b> accounts</a></li>
<li class="chapter" data-level="9.4.6" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#sview"><i class="fa fa-check"></i><b>9.4.6</b> sview</a></li>
<li class="chapter" data-level="9.4.7" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#quota"><i class="fa fa-check"></i><b>9.4.7</b> quota</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="running-jobs-on-midway.html"><a href="running-jobs-on-midway.html#parameter-sweeps"><i class="fa fa-check"></i><b>9.5</b> Parameter sweeps</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="onboarding.html"><a href="onboarding.html"><i class="fa fa-check"></i><b>10</b> Onboarding</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cobey Lab Handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="running-jobs-on-midway" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Running Jobs on Midway</h1>
<p>I’ll leave most of the details to the official documentation:</p>
<p><a href="https://rcc.uchicago.edu/docs/using-midway/#using-midway" class="uri">https://rcc.uchicago.edu/docs/using-midway/#using-midway</a></p>
<p>but a summary of important stuff follows.</p>
<div id="overview" class="section level2">
<h2><span class="header-section-number">9.1</span> Overview</h2>
<p>Midway consists of a large number of multi-core nodes, and uses a system called <a href="http://slurm.schedmd.com">SLURM</a> to allocate jobs to cores on nodes.</p>
<p>Some details on the terminology: a “node” is what you normally think of as an individual computer: a box with a motherboard, a hard drive, etc., running a copy of Linux. Each node’s motherboard contains several <a href="http://en.wikipedia.org/wiki/Microprocessor">processors</a> (a physical chip that plugs into the motherboard), each of which may contain several cores. A “core” is a collection of circuits inside the processor that can, conceptually speaking, perform one series of instructions at a time. (Until a few years ago, processors only consisted of one core and people talked about “processors” the way they now talk about “cores,” so you might hear people confusing these from time to time.)</p>
<p>If you are writing code that does only one thing at a time (serial code), then all you really need to know is that a single run of your code requires a single core.</p>
</div>
<div id="job-structure" class="section level2">
<h2><span class="header-section-number">9.2</span> Job structure</h2>
<p>Note that Midway counts service units, or core-hours in increments of 0.01. To minimize waste, we’re best off designing jobs to be at least several minutes each. (It makes sense that we wouldn’t want to bog down the scheduler anyway.)</p>
</div>
<div id="priority" class="section level2">
<h2><span class="header-section-number">9.3</span> Priority</h2>
<p>As described below, if your jobs aren’t running right away, you can use</p>
<pre><code>$ squeue -u &lt;CNetID&gt;</code></pre>
<p>to see what’s going on.</p>
<p>If your jobs are queued with <code>(Priority)</code> status, it means other jobs are taking priority. Job priorities are determined by the size of the job, its time in the queue, the requested wall time (so it pays to be precise and know your jobs well), and group-level prior usage. Groups that have consumed fewer resources get higher priority than those using more. This usage has a half-life of approximately 14 days, which means it’s less awkward to spread jobs out over time. You can view the priority of queued jobs using</p>
<pre><code>$ sprio</code></pre>
</div>
<div id="useful-commands" class="section level2">
<h2><span class="header-section-number">9.4</span> Useful commands</h2>
<div id="sinteractive" class="section level3">
<h3><span class="header-section-number">9.4.1</span> sinteractive</h3>
<p>To get a dedicated job that you can interact with just like any login session–e.g., if you want to manually type commands at the command line to try some code out, make changes, do some analysis, etc.–you can use the <code>sinteractive</code> command:</p>
<p><a href="https://rcc.uchicago.edu/docs/using-midway/#sinteractive" class="uri">https://rcc.uchicago.edu/docs/using-midway/#sinteractive</a></p>
<p>If you connected via <code>ssh -X</code>, then graphical windows will also get forwarded from the cluster to your local machine.</p>
</div>
<div id="sbatch" class="section level3">
<h3><span class="header-section-number">9.4.2</span> sbatch</h3>
<p>To submit a single non-interactive job to the cluster, use the <code>sbatch</code> command:</p>
<p><a href="https://rcc.uchicago.edu/docs/using-midway/#sbatch" class="uri">https://rcc.uchicago.edu/docs/using-midway/#sbatch</a></p>
<p>This involves preparing a script with special indications to SLURM regarding how much memory you need, how many cores, how long you want the job to run, etc.</p>
</div>
<div id="squeue" class="section level3">
<h3><span class="header-section-number">9.4.3</span> squeue</h3>
<p>View jobs you are currently running:</p>
<pre><code>$ squeue -u &lt;CNetID&gt;</code></pre>
</div>
<div id="scancel" class="section level3">
<h3><span class="header-section-number">9.4.4</span> scancel</h3>
<p>Cancel jobs by job ID:</p>
<pre><code>$ scancel &lt;job-ID&gt;</code></pre>
<p>Cancel all of your jobs:</p>
<pre><code>$ scancel -u &lt;CNetID&gt;</code></pre>
</div>
<div id="accounts" class="section level3">
<h3><span class="header-section-number">9.4.5</span> accounts</h3>
<p>Display number of used/available CPU-hours for the lab:</p>
<pre><code>$ accounts balance</code></pre>
<p>Display number of CPU hours used by you:</p>
<pre><code>$ accounts usage</code></pre>
</div>
<div id="sview" class="section level3">
<h3><span class="header-section-number">9.4.6</span> sview</h3>
<p>If you’re connected graphically to Midway (either via <code>ssh -X</code> or using ThinLinc), you can get a graphical view of the SLURM cluster, which makes it easy to do things like selectively cancel a bunch of jobs at once:</p>
<pre><code>$ sview</code></pre>
<p>The most useful command: Actions &gt; Search &gt; Specific User’s Job(s)</p>
</div>
<div id="quota" class="section level3">
<h3><span class="header-section-number">9.4.7</span> quota</h3>
<p>Display storage usage:</p>
<pre><code>$ quota</code></pre>
<p>The standard quota on an individual account is 25GB. When you exceed this, Midway will notify you the next time you log in. There is a grace period of 7 days to adjust your usage. There is also a hard limit of 30GB.</p>
</div>
</div>
<div id="parameter-sweeps" class="section level2">
<h2><span class="header-section-number">9.5</span> Parameter sweeps</h2>
<p>TODO</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="configuring-software-on-midway.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="onboarding.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-so_you_wanna.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
